# Aegis Mailer v1.0.1 ğŸ›¡ï¸

**Enhanced Email Delivery with Tracking, Webhooks, and Developer Experience Improvements**

## ğŸš€ What's New in v1.0.1

This release focuses on production readiness with delivery tracking, webhook notifications, and significant developer experience improvements.

## âœ¨ Key Enhancements

### ğŸ“Š **Delivery Tracking & Monitoring**
- **Message ID Tracking**: Each email now has a unique identifier passed through the entire pipeline
- **Delivery Status**: Real-time tracking of email delivery status
- **Status API Endpoints**: New `/status` and `/health` endpoints for monitoring
- **Message Status Query**: Check individual message delivery status

### ğŸ”— **Webhook Integration**
- **Delivery Notifications**: Configurable webhook notifications for delivery events
- **Event-Driven Architecture**: Asynchronous webhook processing
- **Reliable Delivery**: Built-in retry mechanism for webhook failures

### ğŸ“§ **Enhanced Email Compatibility**
- **React Email Template Support**: Improved HTML rendering for modern email templates
- **Spam Filter Avoidance**: Enhanced email structure to improve deliverability
- **Better Unicode Handling**: Improved UTF-8 support for international content

### ğŸ› ï¸ **Developer Experience**
- **Enhanced Development Scripts**: New `start-dev.php` script for streamlined local development
- **Improved Queue Management**: Enhanced CLI tools with better error handling
- **Production Server Script**: Dedicated `start-server.php` for production deployments
- **Better Logging**: Enhanced structured logging with delivery tracking metadata

## ğŸ”§ Updated API Endpoints

### New Endpoints
- **`GET /health`** - Health check endpoint for load balancers
- **`GET /status`** - Service status and queue information  
- **`GET /message/{id}/status`** - Individual message delivery status

### Enhanced Endpoints
- **`POST /send`** - Now returns message ID for tracking
```json
{
  "status": "queued",
  "messageId": "550e8400-e29b-41d4-a716-446655440000",
  "message": "Email queued for delivery"
}
```

## ğŸ“¦ Migration Notes

### New Environment Variables
```bash
# Webhook configuration (optional)
WEBHOOK_URL=https://your-app.com/webhook/email-status
WEBHOOK_SECRET=your-webhook-secret

# Enhanced logging
LOG_LEVEL=info
```

### Updated Dependencies
- Enhanced PHPMailer integration
- Improved queue handling with delivery tracking
- New webhook notification system

## ğŸ¯ Usage Examples

### Message Tracking
```bash
# Send email and get message ID
curl -X POST http://localhost:8080/send \
  -H "X-API-Key: your-api-key" \
  -d '{"to":"user@example.com","subject":"Test","body":"Hello!"}'

# Check message status
curl http://localhost:8080/message/{messageId}/status \
  -H "X-API-Key: your-api-key"
```

### Webhook Setup
```php
// Your webhook endpoint receives:
{
  "messageId": "550e8400-e29b-41d4-a716-446655440000",
  "status": "delivered|failed",
  "timestamp": "2025-01-15T10:30:00Z",
  "error": null
}
```

## ğŸ› Bug Fixes

- Fixed queue worker stability issues
- Improved error handling in email processing
- Enhanced attachment processing reliability
- Better memory management for large email queues

## ğŸ”„ Breaking Changes

**None** - This release maintains full backward compatibility with v1.0.0

## ğŸŒŸ Perfect For

- **Production Monitoring**: Track email delivery success rates
- **Integration Workflows**: Webhook-driven email status updates  
- **Modern Applications**: React Email template compatibility
- **DevOps**: Health checks and monitoring endpoints

## ğŸ“Š Technical Improvements

- ğŸ†” **Message ID Propagation** through entire email pipeline
- ğŸ“ˆ **Delivery Metrics** collection and reporting
- ğŸ”— **Webhook Infrastructure** with retry logic
- ğŸ¨ **Enhanced Template Support** for modern email frameworks
- ğŸ›¡ï¸ **Improved Spam Filtering** avoidance techniques

---

**Upgrade today** to get enhanced tracking, webhooks, and improved developer experience! ğŸ‰

### Upgrade Instructions
```bash
git pull origin main
composer install
# Review .env.example for new optional webhook settings
php bin/queue restart --daemon
```